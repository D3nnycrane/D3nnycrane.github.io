<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>A01: Broken Access Control - Mark J. Haakma</title>

<!-- Fonts: Orbitron for headers/nav, Roboto for body -->
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;800&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;600&display=swap" rel="stylesheet" />

<style>
  body {
    font-family: "Roboto", sans-serif;
    margin: 0;
    padding: 0;
    background-color: #0a0f1f;
    color: #f0f8ff;
    scroll-behavior: smooth;
    overflow-x: hidden;
  }

  /* ---------------- HEADER ---------------- */
  .cyber-header {
    background: linear-gradient(135deg, #0a0f1f 0%, #00152d 40%, #002b55 100%);
    padding: 2.5rem 1rem 3.5rem;
    text-align: center;
    position: relative;
    overflow: hidden;
    border-bottom: 2px solid #29bfff50;
    box-shadow: 0 0 25px #009dff40;
  }

  .header-rain {
    position: absolute;
    top: 0;
    left: 0;
    width: 100vw;           /* covers full viewport width */
    height: 100%;
    z-index: 0;
    opacity: 0.35;
    pointer-events: none;
  }

  .cyber-title {
    position: relative;
    z-index: 2;
    font-family: "Orbitron", sans-serif;
    font-size: 2.2rem;
    font-weight: 800;
    letter-spacing: 2px;
    color: #4ecbff;
    margin-bottom: 0.3rem;
    text-shadow: 0 0 4px #29bfff, 0 0 8px #009dff, 0 0 15px #007acc;
    animation: titleGlow 4s ease-in-out infinite;
  }

  @keyframes titleGlow {
    0%, 100% { text-shadow: 0 0 4px #29bfff, 0 0 8px #009dff, 0 0 15px #007acc; }
    50% { text-shadow: 0 0 8px #4ecbff, 0 0 16px #00b7ff, 0 0 25px #00c8ff; }
  }

  /* ---------------- BUTTON ---------------- */
  .cyber-header a.home-button-cyber {
      position: relative;
      z-index: 2;
      display: inline-block;
      margin-top: 1rem;
      padding: 0.6rem 1.2rem;
      background: #007acc;
      color: white !important;
      font-weight: bold;
      text-decoration: none;
      border-radius: 6px;
      font-family: "Orbitron", sans-serif;
      box-shadow: 0 0 8px #007accaa;
      border: none;
      transition: all 0.25s ease;
      text-align: center;
  }

  .cyber-header a.home-button-cyber:hover {
      background: #00aaff;
      color: white !important;
      transform: translateY(-3px) scale(1.04);
      box-shadow: 0 0 12px #39c2ff, 0 0 28px #00aaff, 0 0 45px #0099ff, inset 0 0 6px #007acc;
  }

  nav.jump-nav {
    background: #0f1424;
    border-bottom: 2px solid #007acc22;
    padding: 0.5rem 1rem;
    display: flex;
    justify-content: center;
    gap: 1.5rem;
    position: sticky;
    top: 0;
    z-index: 10;
  }

  nav.jump-nav a {
    color: #4ecbff;
    text-decoration: none;
    font-family: "Orbitron", sans-serif;
    letter-spacing: 1px;
    transition: color 0.3s ease, text-shadow 0.3s ease;
  }

  nav.jump-nav a:hover {
    color: #ffffff;
    text-shadow: 0 0 4px #4ecbff, 0 0 8px #29bfff, 0 0 12px #00c8ff;
  }

  .themed-link {
    color: #37a1ff;
    text-shadow: 0 0 4px #29bfff, 0 0 6px #29bfff;
    font-weight: 600;
    text-decoration: none;
    transition: all 0.25s ease;
  }

  .themed-link:hover {
    color: #00d0ff;
    text-shadow: 0 0 8px #00d0ff, 0 0 12px #00d0ff;
  }

  main {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 2rem 1rem;
    max-width: 900px;
    margin: 0 auto;
  }

  section {
    background-color: #111827;
    border-radius: 12px;
    box-shadow: 0 0 6px #007acc33;
    padding: 1.5rem;
    margin-bottom: 2rem;
    width: 100%;
    text-align: left;
    opacity: 0.97;
    transition: box-shadow 0.3s ease;
  }

  section h2 {
    border-bottom: 2px solid #29bfff;
    padding-bottom: 0.3rem;
    color: #4ecbff;
    font-family: "Orbitron", sans-serif;
    font-size: 1.5rem;
    font-weight: 800;
    text-shadow: 0 0 3px #29bfff;
  }

  #overview, 
  #example, 
  #fix {
    text-align: center;
  }

  /* section glow animation */
  /* ⭐ Glow pulse reinstated */
  @keyframes sectionPulse {
    0%   { box-shadow: 0 0 6px #29bfff55; transform: scale(1); }
    50%  { box-shadow: 0 0 18px #4ecbffcc; transform: scale(1.015); }
    100% { box-shadow: 0 0 6px #29bfff55; transform: scale(1); }
  }

  .section-glow {
    animation: sectionPulse 2.2s ease-in-out forwards;
  }

  pre {
    background: #1a1f3a;
    color: #f0f8ff;
    padding: 10px;
    border-radius: 6px;
    overflow-x: auto;
    font-family: monospace;
  }
</style>
</head>

<body>
<header class="cyber-header">
  <canvas class="header-rain"></canvas>
  <h1 class="cyber-title">A01: Broken Access Control</h1>
  <a class="home-button-cyber" href="/OWASP/owasp-top-10.html">OWASP Top 10</a>
  <a class="home-button-cyber" href="../../index.html">Return Home</a>
</header>

<nav class="jump-nav">
  <a href="#overview">Overview</a>
  <a href="#example">Example Exploit</a>
  <a href="#fix">Proper Fix</a>
</nav>

<main>
  <section id="overview">
    <h2>Overview</h2>
    <p>Broken Access Control moved from 5th in 2024 to 1st in the 2025 OWASP Top 10 list. Primarily a failure of the principle of Least Privilege, it opens entities up to unauthorised data access, functions, or administrative actions.</p>
    <p>
        From the 
        <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/" 
          target="_blank" 
          class="themed-link">
          OWASP description
        </a>
        : "Access control enforces policy such that users cannot act outside of their intended permissions. Failures typically lead to unauthorized information disclosure, modification, or destruction of all data or performing a business function outside the user's limits."
      </p>
      <p>These failures usually arise from inconsistent permission checks, insecure default configurations, or developers relying on client-side enforcement rather than validating permissions on the server. Below is an example of what this vulnerability looks like in practice.</p>
  </section>

  <section id="example">
    <h2>Example Exploit</h2>
    <p>As you might expect from the most common control failure, Broken Access Control can be incredibly simple while causing massive issues. For our case study, let's consider the case of an organisation using Role Based Access.</p>
    <p>Suppose we have an organisation using Role Based access control mechanisms to ensure least Privilege is being adhered to. In this organisation, we have Alice, a senior financial analyst, and Bob, an auditing consultant.</p>
      <figure style="text-align: center;">
        <img src="./figure-1.png" alt="User Profiles and Memberships">
        <figcaption style="font-size: 0.9em;">
          <em>
            Figure 1: Bob and Alice's respective membership profiles.
          </em>
        </figcaption>
      </figure>
      <p>In keeping with good Role-Based Access practices, access to the Finance Team network share is correctly limited to members of the Finance Team.</p>
      <figure style="text-align: center;">
        <img src="./figure-2.png" alt="Role-Based access working as intended." style="width: 825px; margin-bottom: 15px;">
        <img src="./figure-3.png" alt="Role-Based access working as intended." style="width: 825px; height: 250px;">
        <figcaption style="font-size: 0.9em;">
          <em>
            Figure 2 & 3: Role based access working correctly in action. Access is limited based on user's group assignments.
          </em>
        </figcaption>
      </figure>
      <p>So far, so great! Role-Based access controls are in place, and the folder's access is restricted only to those groups that require access as part of their job function. But here's where our scenario's problem arises. As an auditor, one of Bob's issues is artefact gathering; it relies on asking someone to ask someone to get data to pass to Bob. Ever the efficient type, Bob approaches the system administrator and outlines his problems. The administrator thinks of a solution - it can't hurt to grant Bob parent folder access, right? It's just one user, who technically has a work-based need to access this information to perform their roles and responsibilities.</p>
      <p>Our helpful administrator comes up with a great solution: since Bob needs access to team folders to complete his audit, how about granting access at the parent folder level? By granting Read access (or even worse, Modify/Full control", Bob should be able to grab what he needs, just so long as he lets the admin knows when he's done! What's the worst that could happen, right?</p>
      <figure style="text-align: center;">
        <img src="./figure-4.png" alt="Bob being given universal access.">
        <figcaption style="font-size: 0.9em;">
          <em>
            Figure 4: Role based access working correctly in action. Access is limited based on user's group assignments.
          </em>
        </figcaption>
      </figure>
      <p>By granting Bob Read & Execute rights at the parent folder level, there shouldn't be anything in Bob's way to get what he needs to complete his audit. But there's a slight problem - this has granted Bob not only unauthorised access to the Finance folder, but to <em>every single share within the parent folder</em>.</p>
      <figure style="text-align: center;">
        <img src="./figure-5.png" alt="Role Based Access being overruled by parent folder inheritance." style="width: 825px;">
        <figcaption style="font-size: 0.9em;">
          <em>
            Figure 5: With parent folder access and permission inheritance, there is now nothing stopping Bob from overriding Role-Based Access.
          </em>
        </figcaption>
  </section>

  <section id="fix">
    <h2>Proper Fix</h2>
    <p>So it seems unlikely, right? You really think this day in age that system administrators, access management personnel, or others are just going to let you have the access you want instead of the access you need? Unfortunately, not only is it very common, it's <strong>the number one factor in some of the world's biggest breaches.</strong></p>
    <ul>
      <li>
        <a href="https://www.bbc.com/news/technology-47812470" class="themed-link" target="_blank"><strong>Facebook (2019)</strong></a>: Exposed personal data of over 540 million users due to overly permissive API endpoints, allowing third-party apps to access information without proper access controls.
      </li>
      <li>
        <a href="https://edition.cnn.com/2019/07/29/business/capital-one-data-breach" class="themed-link" target="_blank"><strong>Capital One (2019)</strong></a>: A breach affecting ~100 million customers occurred when a misconfigured firewall and overly broad IAM permissions allowed an attacker to retrieve sensitive cloud-hosted data.
      </li>
      <li>
        <a href="https://www.bbc.com/news/technology-42075306" class="themed-link" target="_blank"><strong>Uber (2016)</strong></a>: Data of 57 million users was compromised because private S3 buckets and internal systems lacked proper access restrictions, exposing the data to anyone with the links.
      </li>
    </ul>
    <p>So what can organisations do to protect themselves against the issue of broken access control mechanisms? The good news is there is a deep and wide range of practices that organisations of any size, scale and security posture can implement to blunt the odds of being breached in this way: </p>
    <ul>
      <li><strong>Principle of Least Privilege:</strong> Grant users only the permissions they need, regularly review access rights, and remove temporary access when no longer required.</li>
      <li><strong>Use Groups, Not Individual Users:</strong> Assign rights to groups (e.g., Finance, Security, Audit) instead of adding individual users. Avoid “Everyone” or “Authenticated Users” unless absolutely necessary.</li>
      <li><strong>Manage Inheritance Carefully:</strong> Break inheritance on sensitive folders if needed, monitor parent-level changes that could cascade, and use explicit permissions for critical data.</li>
      <li><strong>Audit and Monitoring:</strong> Enable NTFS auditing, log who accesses what and when, and regularly review logs for unusual patterns.</li>
      <li><strong>Temporary Access Controls:</strong> Provide time-limited access for external consultants or temporary staff and automate removal after the project ends.</li>
      <li><strong>Educate Administrators:</strong> Ensure IT staff understand group scope, inheritance, and default permissions to avoid convenience-based misconfigurations.</li>
    </ul>
    <p>Broken Access Control is not an obscure vulnerability; it’s one of the most common sources of major data breaches. As we’ve demonstrated, a simple misconfiguration, even something as innocuous as granting an auditing consultant access at a parent folder, can cascade into exposure of sensitive data. Following best practices like least privilege, proper group management, controlled inheritance, and audit logging can prevent these real-world failures.</p>
  </section>
</main>

<!-- DIGITAL RAIN SCRIPT -->
<script>
const canvas = document.querySelector('.header-rain');
const ctx = canvas.getContext('2d');

function sizeCanvas() {
  const header = document.querySelector('.cyber-header');
  // use offsetWidth so canvas covers the full header area (including when viewport is wide)
  canvas.width = header.offsetWidth;
  canvas.height = header.offsetHeight;
}
sizeCanvas();
window.addEventListener('resize', () => {
  sizeCanvas();
  setup();
});

const chars = "アカサタナハマヤラワ0123456789";
const letters = chars.split("");
const fontSize = 14;
let columns;
let drops;

function setup() {
  columns = Math.floor(canvas.width / fontSize) || 1;
  drops = new Array(columns).fill(1);
}
setup();

function draw() {
  ctx.fillStyle = "rgba(2, 15, 30, 0.08)";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  ctx.fillStyle = "#29bfff";
  ctx.font = fontSize + "px monospace";

  for (let i = 0; i < drops.length; i++) {
    const text = letters[Math.floor(Math.random() * letters.length)];
    ctx.fillText(text, i * fontSize, drops[i] * fontSize);
    if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
      drops[i] = 0;
    }
    drops[i]++;
  }
}
setInterval(draw, 45);
</script>

<!-- SECTION GLOW LOOP SCRIPT -->
<script>
const sections = document.querySelectorAll("main section");

// Function to run the glow sequence once
function runGlowSequence() {
  sections.forEach((sec, idx) => {
    setTimeout(() => {
      sec.classList.remove("section-glow");
      void sec.offsetWidth; // forces reflow so the animation can restart
      sec.classList.add("section-glow");
    }, idx * 700);
  });
}

// Run immediately once
runGlowSequence();

// Then repeat forever every X ms
const totalDuration = sections.length * 700 + 1000;
setInterval(runGlowSequence, totalDuration);
</script>

</body>
</html>
